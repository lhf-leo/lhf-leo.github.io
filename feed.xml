<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Liao Hanfu&#39;s Blog</title>
    <description>I Leo, I learn and I love.</description>
    <link>http://hanfu.space/</link>
    <atom:link href="http://hanfu.space/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Fri, 07 Oct 2016 17:11:46 -0400</pubDate>
    <lastBuildDate>Fri, 07 Oct 2016 17:11:46 -0400</lastBuildDate>
    <generator>Jekyll v3.0.0</generator>
    
      <item>
        <title>ç”¨Slackæ˜¾ç¤ºCodeDeployçŠ¶æ€</title>
        <description>&lt;p&gt;Slackæ˜¯ç›®å‰å¾ˆå¤šäººå·¥ä½œä¸­å¿…ä¸å¯å°‘çš„é€šè®¯å·¥å…·ï¼›CodeDeployæ˜¯AWSä¸Šæ–¹ä¾¿éƒ¨ç½²ä»£ç çš„æœ‰åŠ›åŠ©æ‰‹ã€‚æ¯æ¬¡éƒ¨ç½²ä»£ç æ—¶ï¼Œä½ æ˜¯å¦è‹¦æ¼åœ¨è¿ç»´ç»„çš„é¢‘é“ä¸­é‡å¤åŒæ ·çš„è¯ï¼Ÿç°åœ¨ç»“åˆè¿™ä¸¤ä¸ªå·¥å…·ï¼Œå½“CodeDeployçŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè®©Slackè‡ªåŠ¨å‘é€æ¶ˆæ¯ã€‚
&lt;!--more--&gt;&lt;/p&gt;

&lt;h2 id=&quot;slack&quot;&gt;è®¾ç½®Slack&lt;/h2&gt;

&lt;p&gt;é¦–å…ˆåˆ°Manageæ‰¾åˆ°Custom Integrationsï¼Œåˆ›å»ºIncoming WebHooksã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä½ å¯ä»¥ç›´æ¥è®¿é—®&lt;code&gt;https://your-domin-name-goes-here.slack.com/services/new&lt;/code&gt;ã€‚æ ¹æ®æç¤ºç®€å•è®¾ç½®ä¹‹åï¼Œä½ å°±ä¼šè·å¾—ä¸€ä¸ªWebhook URLï¼Œä¹‹åä¼šç”¨åˆ°ã€‚Slackå°±è®¾ç½®å¥½äº†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;lambda&quot;&gt;åˆ›å»ºLambda&lt;/h2&gt;

&lt;p&gt;è¿™é‡ŒLambdaæŒ‡çš„æ˜¯AWSé‡Œé¢çš„Lambda Functionï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;AWS Lambda runs your code on a high-availability compute infrastructure and performs all the administration of the compute resources, including server and operating system maintenance, capacity provisioning and automatic scaling, code and security patch deployment, and code monitoring and logging. All you need to do is supply your Node.js code.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨AWSä¸­æ‰¾åˆ°Lambda Functionæ¨¡å—ï¼Œåˆ›å»ºæ—¶&lt;code&gt;Code template&lt;/code&gt;é€‰Noneã€‚ç²˜è´´ä¸‹é¢è¿™æ®µä»£ç ï¼Œ&lt;code&gt;æ³¨æ„ç”¨ä½ è‡ªå·±çš„webhook url&lt;/code&gt;ã€‚è¿™æ˜¯Node.jsï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€è¦ï¼Œå¾ˆç®€å•çš„ä¿®æ”¹æ¶ˆæ¯çš„æ ·å¼å’Œå†…å®¹ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;https&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;From SNS:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Records&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Sns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;*&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Records&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Sns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Subject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Records&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Sns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;//pathæ¢ä¸Šä½ è‡ªå·±çš„webhook url&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;hostname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;hooks.slack.com&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/services/your-slack-webhook-url-info-goes-here&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    
    &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;problem with request: &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;    

    &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;%j&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postData&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç„¶åå°±å¯ä»¥æµ‹è¯•äº†ã€‚åœ¨Sample Eventé‡Œé¢ï¼Œç²˜è´´ä¸‹é¢ç®€å•çš„SNSä¿¡æ¯ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Records&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;EventSource&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;aws:sns&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;EventVersion&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;EventSubscriptionArn&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;arn:aws:sns:us-east-1:963529778735:deployment-notice:1b5f9fec-1628-4124-8caf-eb1d68c7c8dc&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;s2&quot;&gt;&amp;quot;Sns&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;Type&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Notification&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;MessageId&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;fc94858f-129b-546f-83c6-d5feec49dbdb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;TopicArn&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;arn:aws:sns:us-east-1:963529778735:deployment-notice&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;Subject&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;CREATED: AWS CodeDeploy d-OJSFEI0CI in us-east-1 to Portal&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;Message&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;{\&amp;quot;region\&amp;quot;:\&amp;quot;us-east-1\&amp;quot;,\&amp;quot;accountId\&amp;quot;:\&amp;quot;963529778735\&amp;quot;,\&amp;quot;eventTriggerName\&amp;quot;:\&amp;quot;Deployment Status Update\&amp;quot;,\&amp;quot;applicationName\&amp;quot;:\&amp;quot;Portal\&amp;quot;,\&amp;quot;deploymentId\&amp;quot;:\&amp;quot;d-OJSFEI0CI\&amp;quot;,\&amp;quot;deploymentGroupName\&amp;quot;:\&amp;quot;Acceptance\&amp;quot;,\&amp;quot;createTime\&amp;quot;:\&amp;quot;Fri Oct 07 19:50:41 UTC 2016\&amp;quot;,\&amp;quot;completeTime\&amp;quot;:null,\&amp;quot;status\&amp;quot;:\&amp;quot;CREATED\&amp;quot;}&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;Timestamp&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;2016-10-07T19:50:42.170Z&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;SignatureVersion&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;Signature&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;TQCHNq0NrX5ldDTF11gBRz95HWkcCJ5fKOvKmv0klGB9A4rC5g1B4Ydv8Z8+DVJO4UszsiDcxnOQ9yHkkaNUZJZ9jLrEtoPtFINokZTJFVkM1kvhqYyOA2ex5zzv/Vs52EwO9aG80NPIS0b8haEHRYMh52DVn4J05QrzwiiHbit67d75ZvEWMCJKWJewGP9nPY4RwnJJnlalyCtmkubNaAJmhiNcqsTg/6TqgMsBXfYxvBVICzmNCtuQrbVRoXTDoCgtwx2G9mQnmM1VgH37MBBibMmc2D/EJpDg+sUico/KEG/s9x1BixDk5Xc6teUPc78kgfJ3enPUjbYEuQwBgQ==&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;SigningCertUrl&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://sns.us-east-1.amazonaws.com/SimpleNotificationService-b95095beb82e8f6a046b3aafc7f4149a.pem&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;UnsubscribeUrl&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&amp;amp;SubscriptionArn=arn:aws:sns:us-east-1:963529778735:deployment-notice:1b5f9fec-1628-4124-8caf-eb1d68c7c8dc&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;MessageAttributes&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç‚¹æµ‹è¯•å°±å¯ä»¥åœ¨Slacké‡Œé¢çœ‹åˆ°æ¶ˆæ¯äº†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;simple-notification-service&quot;&gt;Simple Notification Service&lt;/h2&gt;

&lt;p&gt;åœ¨AWSä¸­æ‰¾åˆ°SNSï¼Œæ–°å»ºä¸€ä¸ªTopicã€‚ç„¶åè®¾ç½®è¿™ä¸ªTopicï¼Œåˆ›å»ºä¸€ä¸ªsubscriptionã€‚åè®®é€‰aws lambdaï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±å¯ä»¥çœ‹åˆ°ä½ åˆšåˆšåˆ›å»ºçš„é‚£ä¸ªlambdaäº†ã€‚è¿™æ ·ï¼Œåªè¦æœ‰æ¶ˆæ¯ä¼ åˆ°SNSï¼Œå®ƒå°±ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªlambdaã€‚&lt;/p&gt;

&lt;h2 id=&quot;codedeploy&quot;&gt;CodeDeploy&lt;/h2&gt;

&lt;p&gt;æ‰¾åˆ°ä½ çš„Deployment Groupï¼Œåˆ›å»ºtriggerç»ƒåˆ°SNSä¸­ä½ åˆšåˆšåˆ›å»ºçš„Topicå°±è¡Œäº†ã€‚è¿™é‡Œæˆ‘ç¢°åˆ°äº†ä¸€ä¸ªæƒé™é—®é¢˜ï¼Œè§£å†³æ–¹å¼åœ¨è¿™ç¯‡æ–‡ç« é‡Œé¢ï¼š&lt;a href=&quot;http://docs.aws.amazon.com/codedeploy/latest/userguide/how-to-sns-service-role-permission.html&quot;&gt;Grant Amazon SNS Permissions to an AWS CodeDeploy Service Role&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;æœ€å&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;rake deploy:development&lt;/code&gt;â€¦æå®šï¼é…·ä¸é…·ï¼Ÿ&lt;/p&gt;
</description>
        <pubDate>Fri, 07 Oct 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/10/07/slack-codedeploy-status/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/10/07/slack-codedeploy-status/</guid>
        
        <category>DevOps</category>
        
        <category>AWS</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>Rubyçš„Class, Modules, Extend, Include, Mixins...</title>
        <description>&lt;p&gt;åˆšå¼€å§‹æ¥è§¦Rubyï¼Œé™¤äº†â€œ Ruby æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€â€ï¼Œæœ€å¤§çš„æ„Ÿè§¦å°±æ˜¯ï¼šå¥½åƒéšä¾¿æ€ä¹ˆå†™éƒ½æ˜¯å¯¹çš„ã€‚å…¶ä¸­æœ€æ˜æ˜¾çš„å°±æ˜¯ Extend å’Œ Include çš„ç”¨æ³•ï¼Œæˆ‘ä¸€ç›´å‡­å€Ÿç€ç±»ä¼¼äºé«˜ä¸­åšè‹±è¯­é€‰æ‹©é¢˜çš„â€œè¯­æ„Ÿâ€æ¥å†³å®šç”¨å“ªä¸€ä¸ªã€‚ç„¶è€Œâ€œå¹¶éå¤å»ç§‹æ‰è‡³â€ï¼Œè¿™ä¸ªé—®é¢˜åº”è¯¥æ—©ç‚¹ææ¸…æ¥šã€‚&lt;/p&gt;

&lt;h1 id=&quot;module--class&quot;&gt;Module è¿˜æ˜¯ Class&lt;/h1&gt;

&lt;p&gt;é¦–å…ˆè¿™ä¸¤ä¸ªè¯­æ³•éƒ½èƒ½ç”¨åœ¨ Module ä¸Šï¼Œä¸èƒ½ç”¨åœ¨ Class ä¸Šã€‚æˆ‘ä»¬å°±å…ˆä» Module å’Œ Class çš„åŒºåˆ«èŠèµ·ã€‚Class å…¶å®å¾ˆç®€å•ç›´æ¥ï¼Œå¤§å®¶å¤§å­¦ä¸€èˆ¬éƒ½æ˜¯ä» Java å¼€å§‹çš„ï¼šå’Œ Java Class æ˜¯ä¸€æ ·çš„ï¼Œç”¨æ¥å®šä¹‰å’Œåˆ›é€ å¯¹è±¡ã€‚è€Œ Module æ˜¯ç”¨æ¥æä¾› namespace å’Œå½“åš mixin ç”¨çš„ï¼Œç¡¬è¦ä½œæ¯”å–»çš„è¯ï¼Œå°±åƒ Java é‡Œé¢ abstract class ä¸ package çš„ç»¼åˆä½“ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šClass è¿™ä¸ªç±»çš„çˆ¶ç±»å°±æ˜¯ Moduleã€‚çœ‹ä¸ªè¡¨å°±éƒ½æ¸…æ¥šäº†ï¼š&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Â &lt;/th&gt;
      &lt;th&gt;Class&lt;/th&gt;
      &lt;th&gt;Module&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;èƒ½å¦åˆå§‹åŒ–&lt;/td&gt;
      &lt;td&gt;èƒ½&lt;/td&gt;
      &lt;td&gt;ä¸èƒ½&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ç”¨é€”&lt;/td&gt;
      &lt;td&gt;å®šä¹‰å’Œæ–°å»ºå¯¹è±¡&lt;/td&gt;
      &lt;td&gt;namespaceï¼Œmixin&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;çˆ¶ç±»&lt;/td&gt;
      &lt;td&gt;Module&lt;/td&gt;
      &lt;td&gt;Object&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ç»§æ‰¿&lt;/td&gt;
      &lt;td&gt;èƒ½ç»§æ‰¿ä¸è¢«ç»§æ‰¿&lt;/td&gt;
      &lt;td&gt;ä¸èƒ½&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Inclusion&lt;/td&gt;
      &lt;td&gt;ä¸èƒ½&lt;/td&gt;
      &lt;td&gt;å¯ä»¥ç”¨ &lt;code&gt;include&lt;/code&gt; åœ¨classå’Œmoduleé‡Œ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Extension&lt;/td&gt;
      &lt;td&gt;ä¸èƒ½&lt;/td&gt;
      &lt;td&gt;å¯ä»¥ç”¨ &lt;code&gt;extend&lt;/code&gt; åœ¨classå’Œmoduleé‡Œ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;åŒ…å«å‡½æ•°&lt;/td&gt;
      &lt;td&gt;Classå‡½æ•°å’Œå®ä¾‹å‡½æ•°&lt;/td&gt;
      &lt;td&gt;Moduleå‡½æ•°å’Œå®ä¾‹å‡½æ•°&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;åŸºæœ¬ä¸Šè®²ï¼ŒClass å°±æ˜¯å…³äºå¯¹è±¡çš„ï¼ŒModule å°±æ˜¯å…³äºæ–¹æ³•çš„ã€‚Module åº”è¯¥æ˜¯å¯ä»¥ç”¨æ¥åœ¨å„ç§ä¸åŒçš„ç±»ä¸­æä¾›æ–¹æ³•ï¼Œæœ€å…¸å‹çš„å°±æ˜¯éªŒè¯æˆæƒâ€”â€”æ‰€æœ‰çš„ç±»éƒ½è¦éªŒè¯æˆæƒï¼Œè¿™äº›æ–¹æ³•å°±åƒAPIä¸€æ ·ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€èˆ¬éƒ½æŠŠ Module æ”¾åˆ° library æ–‡ä»¶å¤¹ä¸‹ã€‚&lt;/p&gt;

&lt;h1 id=&quot;include--extend&quot;&gt;&lt;code&gt;include&lt;/code&gt; è¿˜æ˜¯ &lt;code&gt;extend&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;åˆšåˆšè¯´åˆ°äº† &lt;code&gt;include&lt;/code&gt; å’Œ &lt;code&gt;extend&lt;/code&gt;ï¼Œéƒ½æ˜¯ç”¨æ¥å¼•è¿› modules çš„ã€‚ä¹‹é—´çš„åŒºåˆ«åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸¾ä¸ªå°ğŸŒ°ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Foo&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo1&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;foo1!&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo2&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;foo2!&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;module_function&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:foo2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# foo2!&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Bar&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Foo&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Bar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# foo1!&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Bar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# NoMethodError: private method `f2&amp;#39; called for #&amp;lt;Bar:0x007f9604884b58&amp;gt;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Bar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# NoMethodError: undefined method â€˜foo1â€™ for Bar:Class&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Baz&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Foo&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# foo1!&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# NoMethodError: private method `foo2&amp;#39; called for Bar:Class&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# NoMethodError: undefined method â€˜foo1â€™ for #&amp;lt;Baz:0x1e708&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;å…ˆçœ‹ Foo çš„å®ä¾‹å‡½æ•° foo1ã€‚&lt;code&gt;include&lt;/code&gt; å°±æ˜¯æŠŠ Foo çš„å®ä¾‹å‡½æ•°å˜æˆè‡ªå·±çš„å®ä¾‹å‡½æ•°ã€‚ &lt;code&gt;extend&lt;/code&gt; å°±æ˜¯æŠŠ Foo çš„å®ä¾‹å‡½æ•°å˜æˆè‡ªå·±çš„ç±»å‡½æ•°ã€‚è€Œ Foo çš„ module å‡½æ•°å‘¢ï¼Œåªèƒ½è‡ªå·±ç”¨ï¼Œä¹Ÿå«ç§æœ‰å‡½æ•°ã€‚è¿™æ ·åº”è¯¥å°±å¾ˆæ¸…æ¥šäº†ã€‚&lt;/p&gt;

&lt;p&gt;ä¸è¿‡è¿™é‡Œä¹‹æ‰€ä»¥å¾ˆå®¹æ˜“ææ··æ·†æ˜¯å› ä¸ºä¸€ä¸ª Ruby çš„é€šç”¨æƒ¯ä¾‹ï¼Œå½“ä¸­å°±åŒ…æ‹¬ railsï¼šå¾ˆå¤šæ—¶å€™ï¼Œäººä»¬éƒ½ä¼šé€šè¿‡ &lt;code&gt;included&lt;/code&gt; è¿™ä¸ªæ–¹æ³•æŠŠ Module å†…éƒ¨å®šä¹‰çš„ ClassMethods &lt;code&gt;extend&lt;/code&gt; åˆ°è°ƒç”¨è¿™ä¸ª Module çš„ç±»ä¸­ã€‚æ‰€ä»¥çœ‹èµ·æ¥å¥½åƒä½ åªæ˜¯ &lt;code&gt;include&lt;/code&gt; ä¸€ä¸ª Module ä¹Ÿå¯ä»¥æ·»åŠ ç±»æ–¹æ³•ï¼Œè€Œå…¶å®åªæ˜¯ &lt;code&gt;extend&lt;/code&gt; äº†å¦å¤–ä¸€ä¸ª Module è€Œå·²ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Foo&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;included&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ClassMethods&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ClassMethods&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bar&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;class method&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;instance method&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Baz&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Foo&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# class method&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance method&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# NoMethodError: undefined method â€˜fooâ€™ for Baz:Class&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Baz&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# NoMethodError: undefined method â€˜barâ€™ for #&amp;lt;Baz:0x1e3d4&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;mixin&quot;&gt;æ–°åè¯ Mixin&lt;/h1&gt;

&lt;p&gt;è¯´åˆ°ç°åœ¨ï¼Œ Mixin ä¹Ÿåªæ˜¯ä¸€ä¸ªæ–°åå­—è€Œå·²äº†â€”â€”å°±æ˜¯é‚£äº›å¯‚å¯çš„ç±»ä¸æ»¡è¶³äºç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼Œäºæ˜¯å°± include æ›´å¤š Module æƒ³è¦ä¸€ç»Ÿå¤©ä¸‹ã€‚å¯¹äºè¿™ç§èµ°ç«å…¥é­”ç›²ç›®å´‡æ‹œåŠ›é‡çš„ç±»ï¼Œæˆ‘ä»¬ä¸ºäº†å‘Šè¯«åäººï¼Œå°±ç§°å®ƒä»¬ä¸ºï¼šè¿·ä¿¡ï¼ˆMi Xinï¼‰ã€‚&lt;/p&gt;
</description>
        <pubDate>Fri, 15 Jul 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/07/15/ruby-class-and-module/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/07/15/ruby-class-and-module/</guid>
        
        <category>Ruby</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>ä½ æƒ³è¦ä»€ä¹ˆ</title>
        <description>&lt;p&gt;ä¸‹åˆä¸€ç›´åœ¨çº ç»“å¦‚ä½•ç»™ä¸€ä¸ª inbound call è®¾ç½® status callbackã€‚å¯¹äºæˆ‘ä»¬æ‰“å‡ºå»çš„ç”µè¯ï¼Œcallbackå‚æ•°å¯ä»¥åœ¨è¿™ä¸ªç”µè¯è¿‡ç¨‹ä¸­å‘é€é€šè¯çŠ¶æ€åˆ°æŒ‡å®šåœ°å€ã€‚å¦‚æœä¸èƒ½å¾—åˆ°æ‰“è¿›æ¥çš„ç”µè¯çš„callbackï¼Œæˆ‘ä»¬å°±ä¸çŸ¥é“è¿™ä¸ªç”µè¯ä»€ä¹ˆæ—¶å€™ç»“æŸäº†ã€‚callbackçš„æ„ä¹‰ç®€å•çš„è¯´å°±æ˜¯è®©æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬çš„è¯æ˜¯ä¸æ˜¯è¯´å®Œäº†ã€‚&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;å¯¹äºè¿™ä¹ˆæ£˜æ‰‹çš„é—®é¢˜ï¼Œæˆ‘åªå¥½æ”¾ç©ºè‡ªå·±ã€‚çªç„¶æƒ³èµ·å°æ—¶å€™çš„ä¸€ä»¶è›®æœ‰è¶£çš„äº‹æƒ…ã€‚å¤§æ¦‚æ˜¯åœ¨ä¸‰å¹´çº§çš„æ—¶å€™ï¼Œæˆ‘æ”’äº†å¥½ä¹…çš„æ—©é¤é’±ï¼Œç»ˆäºä¹°åˆ°äº†æ¢¦å¯ä»¥æ±‚çš„ä¸€è¾†å¸…æ°”çš„é¥æ§æ‘©æ‰˜è½¦ã€‚è¶¾é«˜æ°”æ˜‚åœ°åœ¨åŒå­¦ä»¬é¢å‰ç‚«è€€äº†ä¸€æŠŠã€‚å¯æ™šä¸Šå›åˆ°å®¶â€”â€”è°èƒ½æƒ³è±¡å±…ç„¶åˆ°äº†æ™šä¸Šæ‰å‘ç°â€”â€”æˆ‘å¿ƒçˆ±çš„æ‘©æ‰˜è½¦ä¸èƒ½åé€€ï¼å½“æ—¶æˆ‘æŠŠæ‘©æ‰˜è½¦å¼€æ’åˆ°äº†å¢™ä¸Šï¼Œæƒ³å¾€åå¼€æ—¶å´å‘ç°å®Œå…¨æ²¡æœ‰åŠ¨å¼¹ã€‚è§‚å¯Ÿäº†å¾ˆä¹…ä¹Ÿæ²¡çœ‹åˆ°æŸä¼¤çš„è¿¹è±¡ã€‚æƒ´æƒ´ä¸å®‰åˆæœ‰äº›æ„¤æ€’çš„æˆ‘ï¼Œç¬¬äºŒå¤©ä¸€å¤§æ—©å°±æ¥åˆ°å­¦æ ¡é—¨å£çš„å°å–éƒ¨è®¨ä¸ªå…¬é“ã€‚å¹´è½»çš„è€æ¿è‡ªå·±è¯•äº†ä¸€ä¸‹åˆæ£é¼“åŠå¤©ï¼Œå´è¯´å‡ºäº†ä¸€å¥æˆ‘è¿™è¾ˆå­éš¾ä»¥å¿˜è®°çš„è¯ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ä½ è§è¿‡æ‘©æ‰˜è½¦å€’è½¦å—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å½“æ—¶æˆ‘å°±é™·å…¥äº†äººç”Ÿç¬¬ä¸€æ¬¡æ·±å…¥çµé­‚çš„åæ€ï¼Œå¯¹è¿™ä¸ªä¸–ç•Œæ„Ÿåˆ°å½·å¾¨ã€‚æˆ‘æ²¡æœ‰è§è¿‡æ‘©æ‰˜è½¦å€’è½¦ã€‚æ‘©æ‰˜è½¦æœ¬æ¥å°±ä¸ä¼šå€’è½¦ï¼è¿‡äº†ä¸€ä¼šå„¿ï¼Œæˆ‘å°±å»ä¸Šå­¦äº†ï¼Œä¸å†å½·å¾¨ï¼Œå¿ƒé‡Œä¹Ÿæ²¡æœ‰ä¸€ä¸æ¶Ÿæ¼ªï¼Œä»æ¥æ²¡æœ‰å¦‚æ­¤è½»æ¾è¿‡ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ç®¡è¿™ä½å¹´è½»çš„è€æ¿æ˜¯å¦éšä¾¿å¿½æ‚ äº†æˆ‘è¿™ä¸ªå°å±å­©ï¼Œè‡³å°‘æˆ‘çš„å¿ƒä¸­ç§ä¸‹äº†ä¸€é¢—ç§å­ï¼šå½“æˆ‘æƒ³è¦å´ä¸å¾—æ—¶ï¼Œå°±è¦é™ä¸‹æ¥å¥½å¥½æ€è€ƒï¼Œæƒ³è¦çš„ä¸œè¥¿æ˜¯å¦åˆç†ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºæ‰“è¿›æ¥çš„ç”µè¯ï¼Œç”¨æˆ·è‡ªå·±å¬åˆ°éœ€è¦çš„å°±è¡Œäº†ï¼Œæˆ‘å¹¶ä¸éœ€è¦çŸ¥é“æˆ‘çš„è¯æ˜¯ä¸æ˜¯è¯´å®Œäº†ã€‚&lt;/p&gt;
</description>
        <pubDate>Thu, 14 Jul 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E7%94%9F%E6%B4%BB/2016/07/14/what-you-want-is-wrong/</link>
        <guid isPermaLink="true">http://hanfu.space/%E7%94%9F%E6%B4%BB/2016/07/14/what-you-want-is-wrong/</guid>
        
        <category>Twilio</category>
        
        <category>æ„Ÿæ‚Ÿ</category>
        
        
        <category>ç”Ÿæ´»</category>
        
      </item>
    
      <item>
        <title>Sinatra å®ç°åŸç†è¡¥å……</title>
        <description>&lt;p&gt;è¿™ä¸€ç³»åˆ—æ–‡ç« è®²è§£ååˆ†æ·±å…¥ï¼Œæœ‰å¾ˆå¤šæ¦‚å¿µæˆ‘ä¸å¾—ä¸å›å¤´å»æŸ¥é˜…ï¼Œä»ä¸­ä¹Ÿå­¦åˆ°äº†ä¸å°‘ã€‚åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šå°±æ–‡ç« ä¸­å‡ºç°çš„éš¾æ‡‚çš„æ¦‚å¿µï¼Œåšå‡ºä¸€äº›è¡¥å……ã€‚&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;unboundmethod&quot;&gt;UnboundMethod&lt;/h1&gt;

&lt;p&gt;Ruby æ”¯æŒä¸¤ç§å¯¹è±¡åŒ–äº†çš„æ–¹æ³•ï¼šBound å’Œ Unboundã€‚ Boundæ–¹æ³•æ˜¯æŒ‡å’Œä¸€ä¸ªç‰¹å®šå¯¹è±¡ç»‘å®šèµ·æ¥çš„æ–¹æ³•å¯¹è±¡ã€‚ 
Unboundæ–¹æ³•è‡ªç„¶å°±æ˜¯æ²¡æœ‰è¢«ç»‘å®šçš„å˜›ã€‚â•®ï¼ˆï¿£â–½ï¿£ï¼‰â•­ 
Unboundæ–¹æ³•å¯ä»¥é€šè¿‡&lt;code&gt;instance_method&lt;/code&gt;æ¥åˆ›å»ºï¼Œæˆ–è€…ä»¤boundæ–¹æ³•&lt;code&gt;unbind&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;Unboundæ–¹æ³•åªèƒ½åœ¨ç»‘å®šåæ‰èƒ½è¢«è°ƒç”¨ï¼Œè€Œä¸”å¿…é¡»ç»‘å®šåœ¨ä¸€ä¸ª å’Œè¿™ä¸ªæ–¹æ³•è¢«è§£ç»‘ä¸‹æ¥çš„ç±»ï¼ˆå¯¹è±¡ï¼‰çš„å®ä¾‹ ä¸Šï¼ˆåªè¦è¿™ä¸ªå®ä¾‹æ˜¯&lt;code&gt;kind_of?&lt;/code&gt;è¿™ä¸ªç±»å°±è¡Œï¼‰ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Square&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;area&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@side&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;vi&quot;&gt;@side&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;side&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@side&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;side&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;area_un&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Square&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance_method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:area&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Square&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;area_un&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 144&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Sinatraé‡Œé¢å¤§æ¦‚å°±æ˜¯è¿™æ ·ç”¨çš„ï¼Œå½“è·¯å¾„ä¸åŒæ—¶ï¼Œç»‘å®šä¸åŒçš„æ–¹æ³•åœ¨getï¼Œpostä¸Šé¢ã€‚&lt;/p&gt;

&lt;h1 id=&quot;class--self&quot;&gt;class Â«Â self&lt;/h1&gt;

&lt;p&gt;è¿™æ®µä»£ç åœ¨Sinatraæºç é‡Œé¢æœ‰ï¼Œé«˜ç«¯åˆç¥ç§˜ã€‚å…¶å®å°±æ˜¯ç”¨æ¥ä¸º&lt;code&gt;self&lt;/code&gt;å†™ä¸€äº›singletonæ–¹æ³•ã€‚æˆ‘ä»¬é¦–å…ˆä¸è¦ç®¡selfï¼Œå½“ä½œä¸€ä¸ªä¸åŒçš„objectå¥½äº†ï¼Œçœ‹ç”¨æ³•ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;foo&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;inspect&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;quot;bar&amp;quot;&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inspect&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; &amp;quot;bar&amp;quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;foo&amp;#39;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# new object, new singleton class&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inspect&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; &amp;quot;foo&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æ‰€ä»¥&lt;code&gt;class &amp;lt;&amp;lt; self&lt;/code&gt;ä¹Ÿå°±ä¸éš¾ç†è§£äº†ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;value_of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_s&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_of&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; &amp;quot;42&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;å’Œä¸‹é¢ä¸¤ç§æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;value_of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_s&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æˆ–è€…ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;value_of&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_s&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;rack&quot;&gt;Rack&lt;/h1&gt;

&lt;p&gt;Rackåœ¨Rubyçš„ä¸–ç•Œé‡Œé¢æ˜¯ä¸€ç§æ„å»ºæœåŠ¡ç«¯çš„æœ€åŸºæœ¬ï¼Œä½†ä¹Ÿæ˜¯éå¸¸æœ‰æ„æ€çš„æ–¹å¼ã€‚ è€Œä¸”ç†è§£Rackä¹Ÿæ˜¯ç†è§£Sinatraçš„åŸºç¡€ï¼Œæ¯•ç«ŸSinatraæ˜¯åœ¨Rackçš„åŸºç¡€ä¸Šå†™å‡ºæ¥çš„ã€‚ æˆ‘ä»¬å¯ä»¥åªç”¨Rackæ­å»ºä¸€ä¸ªç®€å•çš„åç«¯ç¨‹åºã€‚ ç›´æ¥ä¸Šå®ä¾‹ï¼Œä»£ç ä¿å­˜åˆ°&lt;code&gt;config.ru&lt;/code&gt;ï¼Œç„¶ååœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œ&lt;code&gt;rackup&lt;/code&gt;ï¼Œé»˜è®¤ä¼šåœ¨&lt;code&gt; http://localhost:9292&lt;/code&gt;ä¸‹æ˜¾ç¤ºã€‚ éå¸¸å»ºè®®å¥½å¥½ç ”ç©¶ä¸€ä¸‹è¿™æ®µä»£ç ï¼Œå¯¹äºç†è§£Sinatraå’Œæ•´ä¸ªRubyç¯å¢ƒéƒ½éå¸¸æœ‰å¸®åŠ©ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Application&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;handle_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;REQUEST_METHOD&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;REQUEST_PATH&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;kp&quot;&gt;private&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;handle_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;method_not_allowed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;text/html&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;You have requested the path &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, using GET&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;method_not_allowed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;405&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Method not allowed: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Application&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Fri, 08 Apr 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/08/peek-behind-the-curtain-summary/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/08/peek-behind-the-curtain-summary/</guid>
        
        <category>Sinatra</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>Sinatra å®ç°åŸç†(å››)</title>
        <description>&lt;p&gt;ç¿»è¯‘æ¥è‡ª &lt;em&gt;Sinatra: Up and Running&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;è¿™ä¸€æ®µæš‚æ—¶è¶…å‡ºæˆ‘çš„ç¿»è¯‘èƒ½åŠ›ï¼Œä¸ºäº†å®Œæ•´æ€§å…ˆæŠŠè‹±æ–‡ç‰ˆçš„ç»™å¤§å®¶çœ‹ã€‚ï¼ˆéœ€è¦ç¿»è¯‘çš„åŒå­¦è¯·å°½é‡ç•™è¨€è®©æˆ‘çŸ¥é“æ˜¯å¦æœ‰å¿…è¦ï¼‰&lt;/code&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;dispatching&quot;&gt;Dispatching&lt;/h1&gt;

&lt;p&gt;There is, however, one catch: Sinatra relies on the â€œone instance per requestâ€ principle. However, when running as middleware, all requests will use the same instance over and over again. Sinatra performs a clever trick here: instead of executing the logic right away, it duplicates the current instance and hands responsibility on to the duplicate instead. Since instance creation (especially with all the middleware being set up internally) is not free from a performance and resources standpoint, it uses that trick for all requests (even if running as endpoint) by keeping a prototype object around.&lt;/p&gt;

&lt;p&gt;Example 3-16 shows the secret sauce in Sinatraâ€™s dispatch activities.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-16. The Sinatra dispatch in action&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MySinatra&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Base&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;prototype&lt;/span&gt;
      &lt;span class=&quot;vi&quot;&gt;@prototype&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;new&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;dup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;routing logic not implemented&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Application&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;dispatching-redux&quot;&gt;Dispatching Redux&lt;/h3&gt;

&lt;p&gt;This lets us craft some pretty interesting Sinatra applications. This prototype and instance duplication approach means you can safely use call on the current instance and consume the result of another route. If you remember from the earlier discussion on Rackâ€™s methodology, the call method will return an array. The application in Example 3-17 lets you check the status code and headers of other routes. Figure 3-5 shows the output of the inspector application.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-17. A reflective route inspector&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/example&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;&amp;#39;go to /inspect/example&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/inspect/*&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:splat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;call&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;merge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;PATH_INFO&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Status: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:txt&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Now letâ€™s tie everything together with the code in Example 3-18 and create a Sinatra application that acts as middleware.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-18. Using Sinatra as middleware in a fictional Rails project&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./sinatra_middleware&amp;#39;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./config/environment&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Sinatra&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Application&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MyRailsProject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Application&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/peek-3-5.png&quot; alt=&quot;img&quot; /&gt;
&lt;sup&gt;Figure 3-5. Firing another request internally to inspect the response&lt;/sup&gt;&lt;/p&gt;

&lt;h3 id=&quot;changing-bindings&quot;&gt;Changing Bindings&lt;/h3&gt;

&lt;p&gt;To bring the discussion back to where we began, letâ€™s focus on a block passed to get again. How is it that the instance methods are actually available? If youâ€™ve been working with Ruby for a decent length of time, youâ€™ve probably come across instance_eval, which allows you to dynamically change the binding of a block. Example 3-19 demonstrates how this can be used.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-19. Toying with instance_eval&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irb&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p180&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;foo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;bar&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;foo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;bar&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p180&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;block&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;proc&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;first&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#&amp;lt;Proc:0x00000101017c58@(irb):2&amp;gt;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p180&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;
&lt;span class=&quot;ss&quot;&gt;NameError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;undefined&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variable&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`first&amp;#39; for main:Object&lt;/span&gt;
&lt;span class=&quot;sb&quot;&gt;  from (irb):2:in `&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;irb_binding&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  from (irb):3:in `call&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;irb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;sr&quot;&gt;/Users/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;konstantin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rvm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rubies&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p180&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;irb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:in&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&amp;lt;main&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;sb&quot;&gt;ruby-1.9.2-p180 &amp;gt; array.instance_eval(&amp;amp;block)&lt;/span&gt;
&lt;span class=&quot;sb&quot;&gt;=&amp;gt; &amp;quot;foo&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This is similar to what Sinatra does. In fact, earlier versions of Sinatra do use instance_eval. However, there is an alternative: dynamically create a method from that block, get the unbound method object for that method, and remove the method immediately. When you want to run the code, bind the method object to the current instance and call it.&lt;/p&gt;

&lt;p&gt;This has a few advantages over instance_eval: it results in significantly better performance since the scope change only occurs once as opposed to every request. It also allows the passing of arguments to the block. Moreover, since you can name the method yourself, it results in more readable stack traces. All of this logic is wrapped in Sinatraâ€™s generate_method, which you can examine in Figure 3-6 and Example 3-20.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Caution&lt;/p&gt;

  &lt;p&gt;generate_method is used internally by Sinatra and is not part of the public API. You should not use it directly in your application.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/img/peek-3-6.png&quot; alt=&quot;img&quot; /&gt;
&lt;sup&gt;Figure 3-6. generate_method and its usage in Sinatra&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-20. generate_method from sinatra/base.rb&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;define_method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;instance_method&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;remove_method&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;method_name&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;method&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Fri, 08 Apr 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/08/peek-behind-the-curtain-4/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/08/peek-behind-the-curtain-4/</guid>
        
        <category>ç¿»è¯‘</category>
        
        <category>Sinatra</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>dup å’Œ clone çš„åŒºåˆ«</title>
        <description>&lt;p&gt;è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ½œå¤åˆ¶ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äº&lt;code&gt;clone&lt;/code&gt;æ¯”&lt;code&gt;dup&lt;/code&gt;å¤šåšäº†ä¸¤ä»¶äº‹ï¼š&lt;/p&gt;

&lt;!--more--&gt;

&lt;ul&gt;
  &lt;li&gt;å¤åˆ¶è¯¥å¯¹è±¡çš„singleton&lt;/li&gt;
  &lt;li&gt;ä¿æŒè¯¥å¯¹è±¡çš„frozençŠ¶æ€&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;çœ‹ä¸‹é¢è¿™æ®µä»£ç å°±æ¸…æ¥šäº†ã€‚&lt;/p&gt;

&lt;p&gt;dupï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:foo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;freeze&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; :foo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frozen?&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; true&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##dup&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dup&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; undefined method `foo&amp;#39;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frozen?&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; false&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;##clone&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clone&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; :foo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frozen?&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;
</description>
        <pubDate>Fri, 08 Apr 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/08/dup-vs-clone/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/08/dup-vs-clone/</guid>
        
        <category>Ruby</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>Sinatra å®ç°åŸç†(ä¸‰)</title>
        <description>&lt;p&gt;ç¿»è¯‘æ¥è‡ª &lt;em&gt;Sinatra: Up and Running&lt;/em&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;request--response&quot;&gt;Request å’Œ Response&lt;/h1&gt;

&lt;p&gt;æ›´è¿›ä¸€æ­¥çš„ç†è§£ Sinatra å†…éƒ¨æœºåˆ¶ï¼Œå°±éœ€è¦å¼„æ‡‚ä¸€ä¸ªrequestçš„æµç¨‹ï¼ŒåŒ…æ‹¬ä»å¤„ç†åˆ°ä¼ é€’ä¸€ä¸ªresponseå›å®¢æˆ·ç«¯ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ Rack åœ¨ Sinatra ä¸­çš„è§’è‰²ã€‚&lt;/p&gt;

&lt;h3 id=&quot;rack&quot;&gt;Rack&lt;/h3&gt;

&lt;p&gt;Rackè¿™ä¸ªè§„èŒƒä¸ä»…åªè¢« Sinatra ä½¿ç”¨ï¼ŒRailsï¼ŒMerbï¼ŒRamazeï¼Œè¿˜æœ‰ä¸€äº›åˆ«çš„Rubyé¡¹ç›®ä¹ŸåŒæ—¶åœ¨ä½¿ç”¨ã€‚ è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åè®®ï¼Œè§„å®šä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼ˆæ¯”å¦‚Thinï¼‰å¦‚ä½•ä¸ç¨‹åºå¯¹è±¡ï¼ˆæ¯”å¦‚Sinatra::Applicationï¼‰åä½œã€‚æ€»ä¹‹ï¼ŒRackå®šä¹‰äº†ç¡¬ä»¶å’Œè½¯ä»¶å¯ä»¥ç”¨ä¹‹ç›¸äº’äº¤æµçš„é«˜ç­‰çº§è¯­è¨€ã€‚å¯ä»¥å»çœ‹çœ‹Rackçš„&lt;a href=&quot;http://rack.rubyforge.org&quot; title=&quot;Rack page&quot;&gt;ä¸»é¡µ&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;Rackåè®®çš„æ ¸å¿ƒè§„å®šç¨‹åºå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç»ˆç«¯ï¼Œå¿…é¡»è¦æœ‰&lt;code&gt;call&lt;/code&gt;æ–¹æ³•ã€‚æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯å¤„ç†è€…ï¼Œä¼šè°ƒç”¨&lt;code&gt;call&lt;/code&gt;è¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶è¿˜ä¼šä¼ é€’ä¸€ä¸ªå‚æ•°ã€‚è¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªhashï¼ŒåŒ…æ‹¬æ‰€æœ‰å…³äºrequestçš„ä¿¡æ¯ï¼šHTTPåŠ¨è¯ï¼ˆGETï¼ŒPOSTï¼‰ï¼Œè¯·æ±‚è·¯å¾„ï¼Œè¿˜æœ‰å®¢æˆ·ç«¯å‘æ¥äº†headersç­‰ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ª&lt;code&gt;call&lt;/code&gt;æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªåŒ…æ¶µä¸‰ä¸ªå…ƒç´ çš„æ•°ç»„ã€‚ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ•´å‹çŠ¶æ€ç ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªæˆåŠŸçš„requestå°±ä¼šæ”¶åˆ°ä¸€ä¸ª200çŠ¶æ€ç ï¼Œè¡¨ç¤ºæ²¡æœ‰é”™è¯¯ã€‚ ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªhashï¼ˆæˆ–è€…ç±»ä¼¼hashï¼‰ï¼ŒåŒ…æ¶µæ‰€æœ‰responseçš„headersã€‚è¿™é‡Œä½ å¯ä»¥æ‰¾åˆ°å®¢æˆ·ç«¯æ˜¯å¦éœ€è¦ç¼“å­˜ï¼Œresponseçš„é•¿åº¦ä»¥åŠå…¶ä»–ç±»ä¼¼çš„ä¿¡æ¯ã€‚æœ€åä¸€ä¸ªå°±æ˜¯bodyæ•°ç»„ï¼ˆæˆ–è€…ç±»ä¼¼äºæ•°ç»„ï¼‰ï¼Œåªè¦æœ‰eachæ–¹æ³•å°±è¡Œã€‚&lt;/p&gt;

&lt;h3 id=&quot;sinatra--sinatra&quot;&gt;ä¸ç”¨ Sinatra çš„ Sinatra&lt;/h3&gt;

&lt;p&gt;è¿™æ ·è¿è¡Œä¸€ä¸ªSinatraç¨‹åºè€Œä¸è°ƒç”¨Sinatraçš„æ–¹æ³•æ˜¯å®Œå…¨å¯ä»¥å®ç°ä¹Ÿå¯ä»¥è¢«æ¥å—ã€‚æˆ‘ä»¬è¯•ç€æŠŠä¸€ä¸ªç®€å•çš„sinatraç¨‹åºæ”¾åˆ°çº¯Rackç¯å¢ƒä¸‹ï¼Œçœ‹ä¾‹å­3-12ã€‚&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-12. Simplified equivalent of a Sinatra application using Rack&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MySinatra&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Application&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;kp&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text/html&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PATH_INFO&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Sinatra doesn&amp;#39;t know this ditty!&amp;quot;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Length&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_s&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;thin&amp;#39;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Thin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Server&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MySinatra&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4567&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è¿™ä¸ªä¾‹å­å¤§è‡´ç­‰æ•ˆäº&lt;code&gt;get(&#39;/&#39;) { &#39;hi&#39; }&lt;/code&gt;ã€‚ å½“ç„¶è¿™ä¸å®Œå…¨æ˜¯Sinatraçš„ä»£ç å®ç°ï¼Œå®ƒéœ€è¦æ›´åŠ å…¨é¢ï¼Œè¦èƒ½å¤Ÿå¤„ç†å¾ˆå¤šç”¨ä¾‹ï¼Œæ¶‰åŠåˆ°å°è£…ï¼Œä¼˜åŒ–ç­‰ã€‚ Sinatraä¼šæŠŠenvè¿™ä¸ªhashæ‰“åŒ…åˆ°ä¸€ä¸ªæ–¹ä¾¿çš„å¯¹è±¡é‡Œé¢ï¼Œä»¥requestå¯¹è±¡çš„å½¢å¼ä¾›ä½ çš„ä»£ç ä½¿ç”¨ã€‚åŒæ ·çš„ï¼Œresponseå¯ç”¨äºç”Ÿæˆbodyæ•°ç»„ã€‚å®ƒä»¬éƒ½èƒ½å¾ˆè½»æ˜“åœ°åœ¨ç¨‹åºä¸­è¢«è°ƒç”¨ï¼Œçœ‹çœ‹ä¾‹å­3-13å…·ä½“æ€ä¹ˆåšçš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-13. ä½¿ç”¨ env, request, å’Œ response&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;helpers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;fail&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;something is terribly broken&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PATH_INFO&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path_info&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;final_result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;finish&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Array&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;final_result&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;final_result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;final_result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;first&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;

  &lt;span class=&quot;s2&quot;&gt;&amp;quot;everything is fine&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;rack-it-up&quot;&gt;Rack It Up&lt;/h1&gt;

&lt;p&gt;å¦‚æœä½ å†åˆ°IRBï¼Œè¾“å…¥&lt;code&gt;Sinatra::Application.new.class&lt;/code&gt;ï¼Œä½ ä¼šå‘ç°è¿™ä¸ª&lt;code&gt;new&lt;/code&gt;ä¸ä¼šè¿”å›ä¸€ä¸ªSinatra::Applicationå¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªRack::MethodOverrideå¯¹è±¡ã€‚&lt;/p&gt;

&lt;p&gt;Rackæ”¯æŒåœ¨ä½ çš„ç¨‹åºä¹‹å‰è®¾ç½®chaining filterså’Œchaining routersã€‚ç”¨Rackçš„æœ¯è¯­æ¥è¯´ï¼Œå°±å«middlewareã€‚middlewareåŒæ ·éµå¾ªRackçš„è§„èŒƒï¼Œæœ‰&lt;code&gt;call&lt;/code&gt;æ–¹æ³•å¹¶ä¸”è¿”å›ä¸€ä¸ªä¸Šé¢åˆšåˆšæè¿‡çš„æ•°ç»„ã€‚å®ƒå¹¶ä¸æ˜¯ç®€å•çš„è‡ªå·±ç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ˜¯è°ƒç”¨ä¸åŒçš„ç»ˆç«¯æˆ–è€…middlewareçš„&lt;code&gt;call&lt;/code&gt;æ–¹æ³•ã€‚ç°åœ¨è¿™ä¸ªmiddlewareå¯ä»¥ä¿®æ”¹requestï¼ˆenv hashï¼‰ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹responseï¼Œç„¶ååœ¨åˆ¤æ–­æ˜¯å¦è°ƒç”¨å¦ä¸€ä¸ªç»ˆç«¯æˆ–è€…ä¸€ç³»åˆ—ç»ˆç«¯ã€‚Sinatraè¿”å›Rack::MethodOverrideå¯¹è±¡è€Œä¸æ˜¯Sinatra::Applicationå¯¹è±¡ä»è€Œä¿æŒåœ¨è¿™ä¸ªmiddleware chainingä¸­ã€‚&lt;/p&gt;

&lt;h3 id=&quot;middleware&quot;&gt;Middleware&lt;/h3&gt;

&lt;p&gt;Rackå¯¹äºmiddlewareè¿˜æœ‰é¢å¤–çš„è§„èŒƒã€‚middlewareç”±ä¸€ä¸ª&lt;a href=&quot;https://en.wikipedia.org/wiki/Factory_(object-oriented_programming)&quot; title=&quot;wiki factory&quot;&gt;factory&lt;/a&gt;å¯¹è±¡åˆ›å»ºã€‚è¿™ä¸ªå¯¹è±¡å®ç°äº†&lt;code&gt;new&lt;/code&gt;æ–¹æ³•ï¼›&lt;code&gt;new&lt;/code&gt;æ–¹æ³•æ¥å—è‡³å°‘ä¸€ä¸ªå‚æ•°ï¼Œé‚£å°±æ˜¯å°†ä¼šè¢«è¿™ä¸ªmiddlewareæ‰“åŒ…çš„ç»ˆç«¯ã€‚æœ€åmiddlewareè¿”å›è¿™ä¸ªæ‰“åŒ…å¥½çš„ç»ˆç«¯ã€‚&lt;/p&gt;

&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œfactoryå°±æ˜¯ä¸€ä¸ªclassï¼Œæ¯”å¦‚Sinatra::ShowExceptionï¼Œè€Œè¿™ä¸ªclassçš„å®ä¾‹å°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰ä¸€ä¸ªå›ºå®šç»ˆç«¯çš„å®Œæ•´çš„middlewareã€‚æˆ‘ä»¬å…ˆæŠŠSinatraæ”¾ä¸€è¾¹ï¼Œå†å†™ä¸€ä¸ªç®€å•çš„Rackç¨‹åºã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª&lt;code&gt;Proc&lt;/code&gt;æ¥ä»£æ›¿Sinatraï¼Œå› ä¸ºå®ƒæœ‰&lt;code&gt;call&lt;/code&gt;æ–¹æ³•ã€‚æˆ‘ä»¬ä¹Ÿä¼šç®€å•å†™ä¸€ä¸ªmiddlewareæ¥æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚&lt;/p&gt;

&lt;p&gt;ä½ çš„ç³»ç»Ÿåº”è¯¥å·²ç»å®‰è£…äº†rackè¿™ä¸ªgemï¼Œå› ä¸ºSinatraä¾èµ–è¿™ä¸ªgemã€‚è¿™ä¸ªgemåŒ…æ¶µä¸€ä¸ªå¾ˆå¥½ç”¨çš„å·¥å…·å«&lt;code&gt;rackup&lt;/code&gt;ï¼Œå®ƒå¯ä»¥ç®€å•çš„è¿è¡Œä¸€ä¸ªRackç¨‹åºã€‚åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åå«â€œconfig.ruâ€ï¼Œè¾“å…¥ä¾‹å­3-14ä¸­çš„å†…å®¹ã€‚ä¹‹åï¼Œä½ åªéœ€è¦åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹è¿è¡Œ&lt;code&gt;rackup -p 4567 -s thin&lt;/code&gt;ï¼Œå°±å¯ä»¥åœ¨â€œhttp://localhost:4567/â€çœ‹åˆ°ä½ çš„ç¨‹åºäº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-14. config.ru çš„å†…å®¹&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;MyApp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;proc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ok&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MyMiddleware&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;vi&quot;&gt;@app&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PATH_INFO&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;
      &lt;span class=&quot;vi&quot;&gt;@app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;404&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;not ok&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# this is the actual configuration&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MyMiddleware&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MyApp&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sinatra--middleware&quot;&gt;Sinatra å’Œ Middleware&lt;/h3&gt;

&lt;p&gt;Racké‡Œçš„&lt;code&gt;use&lt;/code&gt;å¾ˆå¥½ç”¨ï¼Œæ‰€ä»¥Sinatraä¹Ÿå®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œç”¨æ³•å’ŒRackå®Œå…¨ä¸€ä¸‹ã€‚çœ‹çœ‹ä¾‹å­3-15æ˜¯æ€ä¹ˆç”¨çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-15. Using use in Sinatra&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;require &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra&amp;#39;&lt;/span&gt;
require &lt;span class=&quot;s1&quot;&gt;&amp;#39;rack&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# A handy middleware that ships with Rack&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# and sets the X-Runtime header&lt;/span&gt;
use Rack::Runtime

get&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Hello world!&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è¿™äº›çœ‹èµ·æ¥å¾ˆå‰å®³ï¼Œä½†æ˜¯å¯¹æˆ‘ä»¬æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿè¿™æ ·ï¼Œä½ å°±å¯ä»¥æŠŠSinatraç¨‹åºç”¨åšmiddlewareäº†å•Šã€‚&lt;/p&gt;

&lt;p&gt;Sinatra::Applicationè¿™ä¸ªç±»å°±æ˜¯factoryï¼Œå¯ä»¥åˆ›å»ºé…ç½®å®Œæ•´çš„middlewareå®ä¾‹ï¼Œä¹Ÿå°±æ˜¯ä½ çš„ç¨‹åºå®ä¾‹ã€‚å½“æœ‰requestè¿›æ¥æ—¶ï¼Œæ‰€æœ‰çš„&lt;code&gt;before&lt;/code&gt;è¿‡æ»¤å™¨å°±ä¼šå…ˆæ‰§è¡Œä¸€é, å¦‚æœæ²¡æœ‰routeç¬¦åˆï¼Œå°±æŠŠè¿™ä¸ªrequestä¼ é€’ç»™æ‰“åŒ…å¥½çš„ç»ˆç«¯ç¨‹åºã€‚åœ¨routeå¤„ç†å®Œæˆ–è€…ç»ˆç«¯ç¨‹åºå¤„ç†å®Œä¹‹åï¼Œ&lt;code&gt;after&lt;/code&gt;è¿‡æ»¤å™¨å°±ä¼šè¢«æ‰§è¡Œä¸€éã€‚å› æ­¤ï¼Œè¿™ä¸ªSinatraç¨‹åºå°±æ˜¯ä¸€ä¸ªRackçš„middlewareã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;è¡¥å……&lt;/p&gt;

  &lt;p&gt;è¿™ä¸€ç« è¾ƒéš¾ç†è§£ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹Rackç›¸å…³çŸ¥è¯†ã€‚ä¹Ÿå¯ä»¥åœ¨&lt;a href=&quot;http://webapps-for-beginners.rubymonstas.org/rack.html&quot; title=&quot;Webapps For Beginners&quot;&gt;è¿™é‡Œ&lt;/a&gt;æ‰¾ä¸€äº›ç®€å•æ˜“æ‡‚çš„è¡¥å……ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
</description>
        <pubDate>Thu, 07 Apr 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/07/peek-behind-the-curtain-3/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/07/peek-behind-the-curtain-3/</guid>
        
        <category>ç¿»è¯‘</category>
        
        <category>Sinatra</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>Sinatra å®ç°åŸç†(äºŒ)</title>
        <description>&lt;p&gt;ç¿»è¯‘æ¥è‡ª &lt;em&gt;Sinatra: Up and Running&lt;/em&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;h1 id=&quot;helpers--extensions&quot;&gt;Helpers å’Œ Extensions&lt;/h1&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨ç¨å¾®å±é™©ä¸€ç‚¹çš„æ–¹å¼ä½¿ç”¨ Sinatraã€‚è™½ç„¶ä½¿ç”¨DSLå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥ä½¿ç”¨modularé£æ ¼ï¼Œä½†è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼›æ¯•ç«ŸDSLå¼ºå¤§æ–¹ä¾¿ã€‚ä½†è¿˜æ˜¯æœ‰ä¸€äº›DSLåŸç”Ÿä¸æ”¯æŒçš„äº‹æƒ…ã€‚&lt;/p&gt;

&lt;p&gt;å»¶ä¼¸ Sinatra åŠŸèƒ½çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ä¸ªï¼šextension methodså’Œhelpersã€‚ ä½ å…¶å®å·²ç»åœ¨ç”¨extension methodsäº†; æ˜æ˜¾çš„ä¾‹å­å°±æ˜¯ç»„æˆå¤§éƒ¨åˆ†classicç¨‹åºçš„route handlersï¼ˆæ¯”å¦‚getï¼‰ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æç¤º&lt;/p&gt;

  &lt;p&gt;å½“åˆ›å»ºextension å’Œ helperæ—¶ï¼Œbest practiceæ˜¯æŠŠå®ƒä»¬æ‰“åŒ…åœ¨ä¸€ä¸ªmoduleé‡Œé¢å¹¶ç”¨registeræ–¹æ³•è®©Sinatraå†³å®šåœ¨å“ªç”¨è¿™äº›modulesä½œä¸ºmixinsã€‚ç¨‹åºå‘˜ä½•è‹¦ä¸ºéš¾ç¨‹åºå‘˜ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;sinatra-extensions&quot;&gt;åˆ›å»º Sinatra Extensions&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥ç®€å•çš„åˆ›å»ºä¸€ä¸ªextensionã€‚ å‡è®¾æˆ‘ä»¬éœ€è¦å‘é€ GET å’Œ POST è¯·æ±‚åˆ°åŒä¸€ä¸ªç‰¹å®šçš„URLå¯ä»¥è¢«åŒæ ·çš„æ–¹æ³•å¤„ç†ã€‚ æˆ‘ä»¬è¿™ä¹ˆç‰›é€¼ï¼Œå½“ç„¶è¦éµå¾ª DRY åŸåˆ™ï¼Œä¸èƒ½å†™ä¸¤ä¸ªå®Œå…¨ä¸€æ ·çš„routesçš„ä»£ç ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªextensionåœ¨å¤„ç†è¿™ä¸ªæƒ…å†µã€‚ çœ‹çœ‹ä¾‹å­3-6.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-6. åˆ›å»º Sinatra::PostGet extension&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra/base&amp;#39;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Sinatra&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PostGet&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;post_get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;route&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;block&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# registerä¸€ä¸‹&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;register&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;PostGet&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;åœ¨â€œsinatraâ€æ–‡ä»¶å¤¹ä¸‹é¢ç®€å•åœ°åˆ›å»ºä¸€ä¸ªsinatraç¨‹åºï¼Œå’Œä½ çš„extensionï¼Œå°±å«â€œpost_get.rbâ€ã€‚ ä¾‹å­3-7å‘Šè¯‰æˆ‘ä»¬æ€ä¹ˆç”¨ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;æç¤º&lt;/p&gt;

  &lt;p&gt;æˆåŠŸä¹‹åä½ å¯ä»¥è¯•è¯•æŠŠ&lt;code&gt;register&lt;/code&gt;è¯­å¥å»æ‰ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;sub&gt;Example 3-7. ä½¿ç”¨è‡ªå®šä¹‰çš„ Sinatra::PostGet extension&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra&amp;#39;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./sinatra/post_get&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;post_get&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;s2&quot;&gt;&amp;quot;Hi &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¯ä»¥æ‰“å¼€telnetçœ‹çœ‹è¿è¡Œå¾—æ€ä¹ˆæ ·ã€‚&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;telnet 0.0.0.0 4567
Trying 0.0.0.0...
Connected to 0.0.0.0.
Escape character is &lt;span class=&quot;s1&quot;&gt;&amp;#39;^]&amp;#39;&lt;/span&gt;.
GET / HTTP/1.1
Host: 0.0.0.0

  HTTP/1.1 &lt;span class=&quot;m&quot;&gt;200&lt;/span&gt; OK
  Content-Type: text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;utf-8
  Content-Length: 3
  Connection: keep-alive
  Server: thin 1.2.11 codename Bat-Shit Crazy

  Hi

POST / HTTP/1.1
Host: localhost:4567
Content-Length: 7

&lt;span class=&quot;nv&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bar

  HTTP/1.1 &lt;span class=&quot;m&quot;&gt;200&lt;/span&gt; OK
  Content-Type: text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;utf-8
  Content-Length: 3
  Connection: keep-alive
  Server: thin 1.2.11 codename Bat-Shit Crazy

  Hi&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æˆåŠŸäº†å§ï¼Ÿçœ‹èµ·æ¥è¿˜æ˜¯å¾ˆå‰å®³çš„ã€‚&lt;/p&gt;

&lt;h3 id=&quot;helpers&quot;&gt;Helpers&lt;/h3&gt;

&lt;p&gt;Helpers å’Œ extensionsçœ‹èµ·æ¥å·®ä¸å¤šä½†è¿˜æ˜¯æœ‰ä¸åŒçš„ã€‚ å’Œextensionç”¨&lt;code&gt;register&lt;/code&gt;ä¸åŒï¼Œhelpersç”¨&lt;code&gt;helpers&lt;/code&gt;ã€‚â•®ï¼ˆï¿£â–½ï¿£ï¼‰â•­ &lt;code&gt;æ›´é‡è¦çš„æ˜¯ï¼Œä»–ä»¬ä¸ä»…å¯ä»¥ç”¨åœ¨routesçš„ä»£ç ä¸­ï¼Œè¿˜å¯ä»¥ç”¨åœ¨æ¨¡ç‰ˆä¸­ï¼Œåœ¨æ•´ä¸ªç¨‹åºä¸­æé«˜æ•ˆç‡ã€‚&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…¸å‹çš„helperæ–¹æ³•ï¼šç”Ÿæˆhyperlinksã€‚ çœ‹ä¾‹å­3-8.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-8. ä¸€ä¸ªç”Ÿæˆ hyperlinks çš„ helper&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra/base&amp;#39;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Sinatra&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;LinkHelper&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:about&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/about&amp;#39;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:index&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/index&amp;#39;&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/page/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;helpers&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;LinkHelper&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ä½ åªéœ€è¦&lt;code&gt;require &#39;./sinatra/link_helper&#39;&lt;/code&gt;å°±å¯ä»¥äº†ã€‚ åœ¨Erbé‡Œé¢ç”¨çš„æ•ˆæœçœ‹ä¾‹å­3-9.&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-9. ä¸€ä¸ª Erb æ¨¡ç‰ˆæ¥æµ‹è¯• module&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Link Helper Test&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;nav&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;ul&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;li&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;%= link(:index) %&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Index&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;li&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;%= link(:about) %&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;About&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;li&amp;gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;lt;%= link(:random) %&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Random&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/ul&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/nav&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è¿™äº›é“¾æ¥å®Œç¾åœ°æŒ‡å‘&lt;code&gt;/index&lt;/code&gt;ï¼Œ&lt;code&gt;/about&lt;/code&gt;ï¼Œå’Œ&lt;code&gt;/page/random&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;h4 id=&quot;moduleshelpers&quot;&gt;ä¸åœ¨Modulesä¸‹çš„Helpers&lt;/h4&gt;

&lt;p&gt;æœ‰æ—¶å€™ä½ å°±æ˜¯æƒ³ç®€å•å†™ä¸€ä¸¤ä¸ªæ–¹æ³•ï¼Œå¦å»ºä¸€ä¸ªmoduleæœ‰ç‚¹å°é¢˜å¤§åšäº†ã€‚é‚£ä¹ˆä½ å¯ä»¥ç”¨helpersæ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-10. ç”¨ helpers åˆ›å»º helper&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;helpers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:about&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/about&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:index&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/index&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/page/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;erb&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:index&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/index.html&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;redirect&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;link&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;__END__&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;@@index&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;&amp;lt;a href=&amp;quot;&amp;lt;%= link :about %&amp;gt;&amp;quot;&amp;gt;about&amp;lt;/a&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;helpers--extensions-1&quot;&gt;ç»“åˆ Helpers å’Œ Extensions&lt;/h3&gt;

&lt;p&gt;å¦‚æœä½ æƒ³åœ¨extensioné‡Œé¢é€ä¸€ä¸ªhelperï¼Œé‚£å°±å¯ä»¥ç”¨ä¸€ä¸ªå«registeredçš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä»¥appä¸ºå‚æ•°ã€‚è¯·çœ‹ä¾‹å­3-11ã€‚&lt;/p&gt;

&lt;p&gt;&lt;sub&gt;Example 3-11. ç»“åˆ helpers å’Œ extensions&lt;/sub&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sinatra/base&amp;#39;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;MyExtension&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;Helpers&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# helperæ–¹æ³•å†™è¿™é‡Œ&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;# extensionæ–¹æ³•å†™è¿™é‡Œ&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;registered&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;helpers&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Helpers&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;Sinatra&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;register&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MyExtension&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        <pubDate>Wed, 06 Apr 2016 00:00:00 -0400</pubDate>
        <link>http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/06/peek-behind-the-curtain-2/</link>
        <guid isPermaLink="true">http://hanfu.space/%E6%8A%80%E6%9C%AF/2016/04/06/peek-behind-the-curtain-2/</guid>
        
        <category>ç¿»è¯‘</category>
        
        <category>Sinatra</category>
        
        
        <category>æŠ€æœ¯</category>
        
      </item>
    
      <item>
        <title>ç¬¬ä¸€æ¬¡GREä¸ç¬¬ä¸‰æ¬¡é»‘äº”</title>
        <description>&lt;p&gt;è¿‡å»çš„ä¸€ä¸ªå¤šæœˆé‡Œï¼Œæˆ‘åœ¨å·¥ä½œé—²æš‡ä¹‹ä½™ä¸€ç›´åœ¨å‡†å¤‡GREè€ƒè¯•ã€‚å‡†å¤‡ä»“ä¿ƒï¼Œæœªèƒ½ä¸€æ¬¡è¾¾åˆ°æƒ³è¦çš„æˆç»©ï¼Œä¼‘æ•´ä¸€æ®µæ—¶é—´è¿˜å¾—ç»§ç»­é–æˆ˜ã€‚ç®€çŸ­æ€»ç»“ä¸€ä¸‹ï¼š
&lt;!--more--&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;å•è¯æŒ‰ç…§&lt;em&gt;æ¨é¹åä¸ƒå¤©&lt;/em&gt;æ¥èƒŒï¼Œæ•ˆæœéå¸¸å¥½ã€‚è¿™æ¬¡è€ƒè¯•ä¸­æˆ‘è§‰å¾—å•è¯æ°´å¹³è¿˜å‡‘åˆï¼Œå°½ç®¡èƒŒå•è¯çš„æ—¶é—´ä¸é•¿ã€‚è¿™ç§èƒŒå•è¯çš„æ–¹æ³•ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯å¤§å‰‚é‡ï¼Œå¤šé‡å¤ã€‚è®°å¿†æ¶ˆé€€æ›²çº¿è¿™ç§ä¸œè¥¿ï¼Œæˆ‘è¿˜æ˜¯æŒæ€€ç–‘æ€åº¦ï¼Œä½†æ˜¯å­¦ä¹ çš„é›†ä¸­å’Œé‡å¤ï¼Œåœ¨æˆ‘ä¸çŸ­çš„å­¦ä¹ ç”Ÿæ¶¯ä¸­ï¼Œç®—å¾—ä¸Šæ–¹æ³•è®ºä¸­çš„ç‘°å®ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;é˜…è¯»ï¼Œæ…¢ã€‚æŠ›å¼€è€ƒè¯•ä¸è¯´ï¼Œæˆ‘å¯¹äºé˜…è¯»æŒæœ‰ä¸€ä»¥è´¯ä¹‹çš„è°¨æ…ã€‚æ˜¯å¥½æ˜¯åï¼Œè§ä»è§æ™ºï¼Œæˆ‘è§‰å¾—ä¸å¤ªå¥½ï¼šç¬¬ä¸€ä½“éªŒå°±ä¸å¥½ï¼Œæœ‰ç‚¹ç´¯ï¼›ç¬¬äºŒæ˜¯æ•ˆç‡ä½ã€‚æ—¢ç„¶è¦è¯´æ•ˆç‡ï¼Œé‚£ä¹ˆå¾—çŸ¥é“ç›®çš„ã€‚æˆ‘è¯»ä¹¦ç¬¬ä¸€ä¸ºè£…é€¼ï¼Œæ…¢è¯»æ²¡æœ‰æ„ä¹‰ï¼›ç¬¬äºŒç‚¹ä¸¥è‚ƒä¸€äº›ï¼Œä¸ºäº†è§è¯†ï¼Œä¹Ÿåº”è¯¥è¿½æ±‚é™¶æ½œçš„ä¸æ±‚ç”šè§£ã€‚æ—¢ç„¶æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆè¯»ä¹¦ç»†åš¼æ…¢å’½æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿä¸“ä¸šï¼Œæƒ…æ„Ÿâ€¦æœ‰å…³ç»†èŠ‚çš„ï¼Œæ¯‹åº¸ç½®ç–‘è¦ç»†ç»†æŠŠç©ã€‚è¿˜æœ‰ä¸€ç‚¹ï¼Œä¸»è¦ä½“ç°åœ¨æ•£æ–‡è¯—æ­Œï¼Œæˆ–å·¨åŒ æœ‰å¦‚æ²ˆä»æ–‡ï¼Œçˆ±ä¼¦å¡çš„å°è¯´ã€‚è¿™äº›æ–‡å­—ï¼Œæ…¢æ…¢çœ‹ï¼Œç”šè‡³è¯»å‡ºæ¥ï¼Œèƒ½å¤Ÿæ‰¾åˆ°ä¸€ç§ç±»ä¼¼éŸ³ä¹çš„éŸµå¾‹ï¼Œæ–°é—»é‡Œé¢æ‰¾ä¸åˆ°ï¼Œå¾®åšé‡Œé¢æ‰¾ä¸åˆ°ï¼Œæµ®èºçš„å¿ƒé‡Œé¢æ‰¾ä¸åˆ°ã€‚ä¸è¿‡è¿™ä¸€äº›ï¼Œå·²ç»å±äºä¸ªäººç™–å¥½çš„èŒƒç•´ï¼Œä¸å…¶è¯´æ˜¯ä¸ºäº†æ‹¾æ‡ä»€ä¹ˆï¼Œæ¯‹å®è¯´æ˜¯ä¸ºäº†æ”¾ä¸‹å§ã€‚ä¸€æ´¾è‡ªè¨€è‡ªè¯­ï¼Œå¯¹äºè¡€æ°”æ–¹åˆšï¼Œç ´é‡œæ²‰èˆŸçš„ä¼å›¾æˆåŠŸçš„æˆ‘ï¼Œåªæ˜¯ä¸ºäº†è¯´æœè‡ªå·±æŠ›ä¸‹æ‰€æœ‰è€åº„ï¼Œæˆä¸ºä¸€åæ¿€è¿›çš„ä¹‰æ— åé¡¾çš„å†¥é¡½ä¸çµçš„é¸¡æ±¤ä¸»ä¹‰æ–—å£«ï¼Œè‡³å°‘åˆ°ä¸‰åå²å§ã€‚æ¡å›è€ƒè¯•è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘æ¯ä¸€ä¸ªverbaléƒ½æœ‰ä¸€æ•´é“å¤§é˜…è¯»é¢˜è¦çè’™ï¼Œèƒ½è®­ç»ƒè‡ªå·±è¯»å¿«ä¸€ç‚¹åº”è¯¥å¯ä»¥ä¸ºä¸‹æ¬¡æˆ˜æ–—èŠ‚çœä¸‹ä¸å°‘æ—¶é—´ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;è‹±è¯­ä½œæ–‡å†æ¥å†™çš„ä¸å¥½ï¼Œå¾—å¤šç»ƒç»ƒã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å°±åœ¨è€ƒè¯•ç»“æŸåçš„ä¸€å¤©ï¼Œæˆ‘è¿æ¥äº†é»‘è‰²æ˜ŸæœŸäº”ã€‚è´­ç‰©æ˜¯å¥³äººçš„å¤©æ€§ï¼Œé»‘äº”å°±æ˜¯å¥³äººçš„ç‹‚æ¬¢ã€‚å¥³å‹æ¥ç¾å›½é™ªæˆ‘ä¸å®¹æ˜“ï¼Œå†å¹¸è‹¦ä¹Ÿè¦è¿å¤œé©±è½¦ï¼Œå¸¦å¥¹å»é™„è¿‘æœ€å¤§çš„Outletså‚åŠ è¿™ä¸€å¹´ä¸€åº¦çš„ç‹‚æ¬¢ã€‚å‡Œæ™¨äº”ç‚¹ï¼Œæˆ‘ä»¬å›åˆ°å®¶ï¼Œå¸¦ç€æˆ˜åˆ©å“ä¸ç–²æƒ«ï¼Œåƒè…°é—´å›´æ»¡å¤´é¢…çš„ç§¦å…µã€‚è¿‡äº†ä¸€ä¸ªå°æ—¶ï¼Œæˆ‘ä»¬åˆå‡ºé—¨äº†ã€‚ç†¹å¾®çš„æ™¨å…‰ä¸‹ï¼Œè·¯é¢å¼¥æ¼«ç€æ·¡æ·¡çš„äº‘é›¾ï¼Œè¿‡å»æˆ‘ä¼šè¯´â€œæœ‰å¦–æ°”â€ï¼Œè€Œé‚£å¤©æˆ‘å¿ƒé‡Œæš—æš—åœ°æƒ³ï¼Œé‚£æ˜¯â€œäººä»¬çš„æ¬²æœ›â€ã€‚å»gamestopå’Œstapleç”»ä¸Šæµ“å¢¨é‡å½©çš„â€”â€”é€—å·ã€‚ä¹‹åæµ‘æµ‘å™©å™©çš„å‘¨æœ«åŠ ä¸Šä¸€ä¸ªæ˜ŸæœŸä¸€ï¼Œæˆ‘å’Œå¥¹ç»§ç»­åœ¨ç½‘ä¸Šä¹°çº¢äº†çœ¼ï¼Œçœ‹ä¸æ¸…price tagï¼Œçœ‹ä¸é€ç½ªä¸ç½šã€‚&lt;/p&gt;

&lt;p&gt;æœ€å–œæ¬¢çš„å‡ ä¸ªå•†å“ï¼ˆé€’å‡ï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Netgear Nighthawk AC1900: è§Šè§å¤šæ—¶ï¼Œæ—¥å¤œæŠŠç©å›¾ç‰‡ï¼Œçœ‹åˆ°çœŸæœºæ‰å‘ç°é‚£ä¹ˆå¤§ã€‚ä½†å‡¡ç”µå­äº§å“ï¼Œé‡çš„å¤§çš„æˆ–å¤šæˆ–å°‘æ˜¯è´¨é‡çš„ä»£åè¯ï¼Œç»™è·¯ç”±å™¨ç‚¹ä¸ªèµï¼›é™¤äº†ä¼ è¾“é€Ÿç‡é«˜å’Œé£˜æ¸ºçš„QoSåŠŸèƒ½ï¼Œè®©æˆ‘ç•¥æœ‰æƒŠå–œçš„æ˜¯è·¯ç”±å™¨çš„æ§åˆ¶å°è¿˜æœ‰ä¸‹è½½åŠŸèƒ½ï¼Œèƒ½ç›´æ¥ä¸‹è½½åˆ°æ¥åœ¨å…¶ä¸Šçš„ç¡¬ç›˜ï¼Œçœæ‰äº†æˆ‘åœ¨Raspberryå¼€å¯transmissionæœåŠ¡çš„éº»çƒ¦ä¸æ€§èƒ½å¼€é”€ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Seagate Backup Plus 5TB: é…åˆä¸Šé¢çš„è·¯ç”±å™¨ç»„æˆç®€æ˜“NASï¼ˆå…¶å®åªæ˜¯smbï¼Œæ²¡æœ‰RAIDï¼‰ï¼ŒåŸºæœ¬å¤Ÿç”¨ã€‚å¯ä»¥é…åˆRaspberryä¸Šçš„plex serverç»„æˆç¨³å®šå¥½ç”¨çš„å®¶åº­åª’ä½“ä¸­å¿ƒã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Walmart Blunder $9: é¦™è•‰ï¼Œè‹¹æœï¼Œç‰›å¥¶ï¼Œè¿˜æœ‰ç‚¹ç›ä¹‹ç¬”&lt;strong&gt;è‹æ‰“æ°´&lt;/strong&gt;ï¼ˆä¸å°å¿ƒå‘ç°çš„ç§˜æ–¹ï¼‰ï¼Œç»™ä½ å¸¦æ¥ä¸ä¸€æ ·çš„milkshakeã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Wii: æƒ³å’Œæœ‹å‹ä¸€èµ·ç©ï¼Œä¹°ï¼›æœ‰å¥³æœ‹å‹ï¼Œä¸€å®šè¦ä¹°ï¼ä»»å¤©å ‚æ‰æœ‰çš„æ¸¸æˆæ€§ã€‚&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Logitech K480: å¯ä»¥è¿æ¥ä¸‰ä¸ªè“ç‰™è®¾å¤‡ï¼Œé€šè¿‡æ—‹é’®åˆ‡æ¢ä½¿ç”¨ã€‚æŒ‰é”®åç¡¬ï¼Œæ— ä¼¤å¤§é›…ã€‚&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å…¶å®æˆ‘è¿˜å…¥æ‰‹äº†ä¸€ä¸ªNvidia Shield TVï¼Œåªæ˜¯è¿˜æ²¡åˆ°è´§ï¼Œå¤–å½¢ä¸é”™å…ˆç‚¹ä¸ªèµã€‚
æ¯”è¾ƒé—æ†¾ï¼ŒåŒæ—¶ä¹Ÿåº†å¹¸çš„ï¼Œæ˜¯æˆ‘æ²¡æœ‰ä¹°åˆ°AV Receiverå’Œç«‹å¼éŸ³ç®±ã€‚çœ‹äº†å¾ˆä¹…ï¼Œæœ€åæ€‚äº†ã€‚&lt;/p&gt;

&lt;p&gt;å„ç§äº‹æƒ…æš‚ä¸”å‘Šä¸€æ®µè½ï¼Œå¯ä»¥æ½œå¿ƒæ•²ä¸€ä¼šå„¿ä»£ç äº†ã€‚&lt;/p&gt;
</description>
        <pubDate>Tue, 01 Dec 2015 00:00:00 -0500</pubDate>
        <link>http://hanfu.space/%E7%94%9F%E6%B4%BB/2015/12/01/after-gre/</link>
        <guid isPermaLink="true">http://hanfu.space/%E7%94%9F%E6%B4%BB/2015/12/01/after-gre/</guid>
        
        <category>éšç¬”</category>
        
        
        <category>ç”Ÿæ´»</category>
        
      </item>
    
      <item>
        <title>Sublime ä½¿ç”¨æ‰‹å†Œ</title>
        <description>&lt;p&gt;ä½¿ç”¨sublimeå¾ˆé•¿ä¸€æ®µæ—¶é—´äº†ï¼Œå„ä¸ªæ–¹é¢éƒ½ä»¤æˆ‘éå¸¸æ»¡æ„ã€‚å› ä¸ºè¿™æ¬¡æ›´æ¢ç³»ç»Ÿï¼Œæ­£å¥½æŠŠä½¿ç”¨æ–¹æ³•å½’çº³ä¸€ä¸‹ã€‚ä¸‹é¢æ˜¯æˆ‘åœ¨ç”¨çš„å›¾æ ‡ä»¥ä¾›åˆ†äº«ï¼š
&lt;img src=&quot;https://raw.githubusercontent.com/YabataDesign/sublime-text-icon/master/Sublime_text_256x256x32.png&quot; alt=&quot;afterglow icon&quot; title=&quot;afterglow&quot; /&gt;
&lt;!--more--&gt;
##å®‰è£…&lt;/p&gt;

&lt;p&gt;åœ¨Windowsï¼ŒOS X å’Œ Ubuntuä¸Šå®‰è£…sublimeéƒ½éå¸¸æ–¹ä¾¿ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹CentOSçš„å®‰è£…æ–¹æ³•ã€‚
é¦–å…ˆï¼Œå»&lt;a href=&quot;http://www.sublimetext.com/3&quot;&gt;Sublimeç½‘ç«™&lt;/a&gt;ä¸‹è½½64ä½æˆ–32ä½&lt;em&gt;tarball&lt;/em&gt;ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨&lt;code&gt;wget&lt;/code&gt;å‘½ä»¤ä¸‹è½½ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;## On 64bit&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget http://c758482.r82.cf2.rackcdn.com/sublime_text_3_build_3083_x64.tar.bz2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç„¶åè§£å‹åˆ°&lt;code&gt;/opt&lt;/code&gt;æ–‡ä»¶å¤¹ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo tar -vxjf sublime_text_3_build_3083_x64.tar.bz2 -C /opt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;å»ºç«‹ä¸€ä¸ªé“¾æ¥åˆ°åˆšåˆšå®‰è£…çš„æ–‡ä»¶å¤¹ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo ln -s /opt/sublime_text_3/sublime_text /usr/bin/sublime3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;åˆ°è¿™é‡Œï¼Œå°±å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯è¾“å…¥&lt;code&gt;sublime3&lt;/code&gt;æ¥æ‰“å¼€è½¯ä»¶äº†ã€‚å¦‚æœéœ€è¦è®©GUIçŸ¥é“å®ƒçš„å­˜åœ¨ï¼ˆæ¯”å¦‚æƒ³åœ¨KDEä¸­çš„App Launcheræ‰¾åˆ°ï¼‰ï¼Œåˆ›å»ºdesktopæ–‡ä»¶ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;sudo sublime3 /usr/share/applications/sublime3.desktop&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;åœ¨è¯¥æ–‡ä»¶ä¸­æ·»åŠ ä¸‹åˆ—è¯­å¥ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Desktop Entry&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Sublime3
&lt;span class=&quot;nv&quot;&gt;Exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sublime3
&lt;span class=&quot;nv&quot;&gt;Terminal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Icon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/opt/sublime_text_3/Icon/48x48/sublime-text.png
&lt;span class=&quot;nv&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Application
&lt;span class=&quot;nv&quot;&gt;Categories&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;TextEditor&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;IDE&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;Development
X-Ayatana-Desktop-Shortcuts&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NewWindow
 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NewWindow Shortcut Group&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;New Window
&lt;span class=&quot;nv&quot;&gt;Exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sublime -n
&lt;span class=&quot;nv&quot;&gt;TargetEnvironment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Unity&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è¿™æ ·å®‰è£…ä¹…æå®šäº†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;section&quot;&gt;è®¾ç½®&lt;/h2&gt;

&lt;p&gt;Sublime ä½¿ç”¨ Json ä½œä¸ºé…ç½®æ–‡ä»¶æ ¼å¼ï¼Œæ–¹ä¾¿ä¿®æ”¹ä¸è¿ç§»ï¼Œæˆ‘åªéœ€è¦å°†åŸæ¥çš„é…ç½®æ–‡ä»¶ï¼ˆsettings-userï¼‰æ›¿æ¢æ‰å°±è¡Œäº†ã€‚ä¸‹é¢æ˜¯æˆ‘ç”¨çš„é…ç½®ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;highlight_line&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;font_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;ignored_packages&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Vintage&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;tab_size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;translate_tabs_to_spaces&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;section-1&quot;&gt;æ’ä»¶&lt;/h2&gt;

&lt;p&gt;Sublime æœ€è®©äººå€¾æ…•çš„åŠŸèƒ½è«è¿‡äºå…¶å¼ºå¤§çš„æ’ä»¶æ”¯æŒã€‚ä¼—å¤šæ’ä»¶å‡ ä¹å¯ä»¥æ»¡è¶³å„ä¸ªæ–¹é¢çš„å·¥ä½œéœ€è¦ã€‚ä¸€èˆ¬åœ°ï¼Œæ¨èä½¿ç”¨&lt;code&gt;Package Control&lt;/code&gt;å®‰è£…ç®¡ç†æ‰€æœ‰æ’ä»¶ï¼Œå®‰è£…éå¸¸ç®€å•ã€‚é¦–å…ˆåœ¨sublimeç•Œé¢ä¸­æŒ‰ä½&lt;code&gt;Ctrl&lt;/code&gt;ï¼‹&lt;code&gt;\&lt;/code&gt;`æ‰“å¼€æ§åˆ¶å°ï¼Œè¾“å…¥ä¸‹åˆ—å‘½ä»¤ï¼ˆæœ€å¥½å»&lt;a href=&quot;https://packagecontrol.io/installation&quot;&gt;å®˜ç½‘&lt;/a&gt;æ ¹æ®ä½ çš„ç‰ˆæœ¬å¤åˆ¶ä»£ç ï¼‰ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;urllib.request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;hashlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;2915d1851351e5ee549c20394736b442&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;8bc59f460fa1548d1514676163dafc88&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Package Control.sublime-package&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ipp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sublime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;installed_packages_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;install_opener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build_opener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ProxyHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urllib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;urlopen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;http://packagecontrol.io/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;%20&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hashlib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sha256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Error validating download (got &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; instead of &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;), please try manual install&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dh&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ipp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç„¶åé‡å¯ï¼Œå°±èƒ½å¼€å§‹å®‰è£…ä¸€äº›éå¸¸å®ç”¨çš„æ’ä»¶äº†ã€‚æŒ‰ä½&lt;code&gt;Ctrl&lt;/code&gt;ï¼‹&lt;code&gt;Shift&lt;/code&gt;ï¼‹&lt;code&gt;P&lt;/code&gt;ï¼Œè¾“å…¥&lt;code&gt;install&lt;/code&gt;é€‰ä¸­&lt;code&gt;Install Package&lt;/code&gt;ï¼Œè¾“å…¥æˆ–é€‰æ‹©ä½ éœ€è¦çš„æ’ä»¶å›è½¦å°±å®‰è£…äº†ï¼ˆæ³¨æ„å·¦ä¸‹è§’çš„çŠ¶æ€æ å˜åŒ–ï¼Œä¼šæç¤ºå®‰è£…æˆåŠŸï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€äº›éå¸¸ä¼˜ç§€çš„å¸¸ç”¨çš„æ’ä»¶ï¼š&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Theme - afterglow&lt;/li&gt;
  &lt;li&gt;HTML-CSS-JS Prettify&lt;/li&gt;
  &lt;li&gt;Alignment&lt;/li&gt;
  &lt;li&gt;ZenCoding&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å”¯ä¸€æœ‰ä¸€äº›é—æ†¾çš„æ˜¯åœ¨linuxä¸Šï¼Œsublimeæ— æ³•è¾“å…¥ä¸­æ–‡ï¼ˆå½“ç„¶ä¹Ÿä¸æ˜¯æ²¡æœ‰åŠæ³•ï¼Œåªæ˜¯è¿‡ç¨‹ç¹çä¸ç”šä¼˜é›…ï¼‰ï¼Œç»™ä¸€å°éƒ¨åˆ†ä½¿ç”¨åœºæ™¯å¸¦æ¥äº†äº›è®¸å›°æ‰°ã€‚å¸Œæœ›sublimeå›¢é˜Ÿèƒ½éƒ½æ—©æ—¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚&lt;/p&gt;

</description>
        <pubDate>Tue, 17 Nov 2015 00:00:00 -0500</pubDate>
        <link>http://hanfu.space/%E5%B7%A5%E5%85%B7/2015/11/17/use-sublime/</link>
        <guid isPermaLink="true">http://hanfu.space/%E5%B7%A5%E5%85%B7/2015/11/17/use-sublime/</guid>
        
        <category>æ­å»ºç¯å¢ƒ</category>
        
        <category>è½¯ä»¶</category>
        
        
        <category>å·¥å…·</category>
        
      </item>
    
  </channel>
</rss>
